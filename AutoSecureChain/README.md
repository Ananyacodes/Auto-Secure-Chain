# AutoSecureChain - ECU firmware scanner

Purpose
- Static-only ECU firmware scanner for detection and triage. It does not modify firmware or attempt to flash devices.
- Finds insecure artifacts (hardcoded credentials, debug interfaces, cleartext services), detects PEM private keys, estimates entropy, runs YARA rules, and optionally verifies detached signatures using a PEM public key.

Files and detailed descriptions
- scanner/scanner.py
  - Implementation of the scanner logic. Computes SHA256, entropy, extracts printable strings, runs compiled YARA rules (if yara-python installed), and performs optional external signature verification using scanner/public_key.pem and a sibling .sig file.
  - Produces reports/report.json (detailed findings) and reports/mitigation_actions.json (flattened suggested actions).
  - Note: signature verification attempts RSA PKCS#1 v1.5 + SHA256 by default; adapt if vendor uses another scheme.

- scanner/rules.yar
  - YARA rule set detecting telnet/cleartext services, hardcoded credentials/provision tokens, debug/JTAG/UART indicators, and PEM private keys.
  - Includes a vendor/provisioning-focused heuristic rule to flag provisioning-token patterns used in recent attacks.

- scanner/sample.bin
  - Demo firmware blob (textual) containing sample triggers for the rules (JAGUAR_PROVISION, PROVISION_TOKEN, telnetd, root:, DEBUG_MODE, fake private key block).
  - For testing only; do NOT place real keys or production tokens here.

- scanner/public_key.pem
  - Placeholder PEM public key used for signature verification. Replace with vendor-supplied public key for real verification.
  - To create a test keypair locally (development only), generate a private key and extract public key with OpenSSL. Keep private keys out of repo.

- reports/report.json
  - Human-readable scan report generated by scanner.py with timestamp and per-file details (sha256, entropy, matches, suspicious strings, signature info, severity_score, recommended_mitigations).

- reports/mitigation_actions.json
  - Machine-readable flattened list of mitigation actions derived from the report; suitable for ticketing or automation.

Usage (PowerShell)
1. Allow script activation for the session if needed:
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process -Force

2. Create and activate a venv; install deps:
   python -m venv venv
   .\venv\Scripts\Activate.ps1
   python -m pip install --upgrade pip
   python -m pip install yara-python cryptography

3. Run scanner:
   python AutoSecureChain\scanner\scanner.py

Notes and security guidance
- The scanner is defensive and conservative. It only reports findings and suggests mitigations.
- Replace the placeholder public key with the vendor's public key to enable real signature verification.
- Avoid committing real private keys, provisioning tokens, or production credentials into the repository.
- Consider adding a whitelist/config per firmware family to reduce false positives.
